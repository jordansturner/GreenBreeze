<!DOCTYPE html>
<html>
<head>
	<title></title>
	<link rel="stylesheet" type="text/css" href="MainPageStyles.css">
<!-- 	<link rel="stylesheet" type="text/css" href="rangeslider.css"> -->
	<link rel="stylesheet" type="text/css" href="nouislider.css">
	<link href="https://fonts.googleapis.com/css?family=Montserrat:300i,300,400,500,600,700|Open+Sans:300,400,400i" rel="stylesheet">
	<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/skrollr/0.6.30/skrollr.min.js"></script>
	<!-- <script src='rangeslider.min.js'></script> -->
	<script src="https://www.gstatic.com/firebasejs/4.9.1/firebase.js"></script>
	<script type="text/javascript" src="nouislider.js"></script>

	<!--font-family: 'Open Sans', sans-serif;
		font-family: 'Montserrat', sans-serif; -->
</head>

<body>
	<div id="nameGardenContentWrapper">
		<div id="darkBackground">
			
		</div>
		<div id="modalBackgroundnameGarden">
			<div id="content3">
				<div id="nameGardenWrapper">
					<div id="CustomFarmImg2Wrapper">
						
					</div>
					<h4 id="congratulations">Congratulations!</h4>
					<h6 id="congratulationsText">Lorem ipsum dolor sit amet, consectetur adipiscing elit</h6>
					<form id="user"><input type="text" name="user" placeholder="NAME YOUR FARM"></form>
					<button id="SubmitNameButton">Join</button>
					<div class="circleXm3">
					</div>
					<button class="xm3" id="missionX3">
					</button>
				</div>
			</div>
		</div> 
	</div>
	<div id="missionStatementContentWrapper">
		<div id="darkBackground">
			
		</div>
		<div id="modalBackground">
			<div id="content2">
				<img id="MissionStatementImg2" src="Assets/PNG_72ppi/Mission_Statement.png">
				<div id="MissionStatementWrapper2">
					<h3 id="MissionStatementTitle2">Mission Statement</h3>
					<h5 id="MissionStatementBody2">
					Herban is not just a company, we are a green-based lifestyle </br>brand. By taking advantage of a digital marketplace, autonomous gardening, and drone delivery system, Herban will sell and deliver locally sourced produce directly to and from our customers' doorsteps.  Our mission is to drive the change required for a sustainable future. By limiting the amount of traditional farmland needed to feed a growing population and by integrating green spaces into every facet of city life, our Green Breeze system will foster environmental rejuvination and healthier city ecosystems.
					</h5>
					<div class="circleXm2">
					</div>
					<button class="xm2" id="missionX2">
					</button>
				</div>
			</div>
		</div> 
	</div>

	<div id="HighLevelNavigationTop">
			<span id="Span1"> <a data-text="OUR MISSION" id="mission_Statement">OUR MISSION</a></span>
		    <span id="Span2"><a href="MainHomePage4.html#introWrapper" data-text="GARDEN BUILDER" id="SelectedNavItem">GARDEN BUILDER</a></span>
		    <span id="Span3"> <a href="MainHomePage4.html" data-text="HERBAN LOGO" id="HerbanLogo4"></a></span>
		    <span id="Span4"><a href="Further_Reading.html" data-text="FURTHER READINGS" ">FURTHER READINGS</a></span>
		    <span id="Span5"><a href="_____" data-text="THE COMMUNITY" >THE COMMUNITY</a></span>
		    <!-- <a href="MainHomePage4.html#introWrapper" data-text="GARDEN BUILDER" id="SelectedNavItem">GARDEN BUILDER</a>
		    <span> <a data-text="OUR MISSION" id="mission_Statement">OUR MISSION </a></span>
		    <span> <a href="MainHomePage4.html" data-text="HERBAN LOGO" id="HerbanLogo4"></a></span>
		    <span><a href="Further_Reading.html" data-text="FURTHER READINGS">FURTHER READINGS</a></span>
		    <span><a href="_____" data-text="THE COMMUNITY" >THE COMMUNITY</a></span> -->
		</div> 
	<div id="GardenBuilderNavigationTop">
	    <a href="GardenBuilder_GrowingPriorities.html" data-text="Growing Priorities" class="GreenNav">Growing Priorities</a>
	    <img src="Assets/checkButton.png" class="check">
	    <div class="line" id="line1"></div>
	    <div class="line" id="line2"></div>
	    <img src="Assets/checkButton.png" class="check2">
	    <div class="line" id="line3"></div>
	    <div class="line" id="line4"></div>
	     <img src="Assets/checkButton.png" class="check3">
	    <div class="line" id="line5"></div>
	    <div class="line" id="line6"></div>
	    <!-- <div class="dot_1"></div>
	    <div class="dot_2"></div> -->
	    <a href="GardenBuilder_UrbanSpaces.html" data-text="Urban Spaces" class="GreenNav">Urban Spaces</a>
	    <a href="GardenBuilder_FarmSystems.html" data-text="Farm Systems" class="GreenNav">Farm Systems</a>
	    <a href="GardenBuilder_FarmCustomization.html" data-text="Farm Customization" id="SelectedNav" class="GreenNav">Farm Customization</a>
	</div> 
	<img id="CongratulationsFineTuneIllustration" src="Assets/PNG_72ppi/Introduction_Customize_Garden.png">
	
	<div id="CongratulationsFineTuneWrapper">
		<h3>Great choices! Now its time to customize your garden.</h3>
		<h5>Scroll to access our dashboard where you will have the chance to personalize your previous choices and see the impact of your garden.</h5>
	</div>
	<a class="arrow-wrap" href="#content">
		<span class="arrow"></span>
	<!--<span class="hint">scroll</span>-->
	</a>
	<div id="CustomFarmWrapper">
		
		<h3 id="choice_Catalog"> Personalize Your Choices</h3>
		<div id="catalog_Wrapper" >
			<div id="priorityWrapper" class="catalogItemWrap">
				<div id="priorityHeader" class="titleHeader"></div>
			</div>
			<div id="scaleWrapper" class="catalogItemWrap">
				<div id="scaleHeader" class="titleHeader"></div>
			</div>
			<div id="costWrapper" class="catalogItemWrap">
				<div id="costHeader" class="titleHeader"></div>
			</div>
		</div>
		<div id="fineTuneSectionWrapper">
			<div id="excerciseWrapper">
				
			</div>
			<div id="resultsHeader">
				
			</div>
			<div id="resultsSectionWrapper">
				<div id="resultsbackground">
					
				</div>
				<table id="final_Results" border="0" cellpadding="12" cellspacing="0" style="border-collapse: collapse; width: 90%; margin: 1.5em; font-family: 'Open Sans', sans-serif;">
					
				<tbody>
					<th style="text-align: left; font-family: 'Montserrat', sans-serif; font-size: 20px; font-weight: 600; color: #559B98;border-spacing: 25px; padding-bottom: 30px;">Urban Farm Results</th>
				    <tr style="border-bottom: 1px solid rgba(85, 155, 152, .4); border-top: 1px solid rgba(85, 155, 152, .4); line-height: 1.8em; font-size: 16px;">
				    	
				      <td style="width: 55%; color: #4A4A4A;">The Value of Crops Grown:</td>
				      <td id="result1" style="width: 45%; font-weight: bold; text-align: right; color: #559B98;">result1</td></tr>
				    <tr style="border-bottom: 1px solid rgba(85, 155, 152, .4); line-height: 1.8em;font-size: 16px"">
				      <td style="width: 55%;  color: #4A4A4A;">The Amount of Water Saved:</td>
				      <td id="result2" style="width: 45%; font-weight: bold;text-align: right; color: #559B98;">result2</td></tr>
				    <tr style="border-bottom: 1px solid rgba(85, 155, 152, .4); line-height: 1.8em;font-size: 16px"">
				      <td style="width: 55%;  color: #4A4A4A;">CO2 Emissions Removed:</td>
				      <td id="result3" style="width: 45%; text-align: right;font-weight: bold; color: #559B98;">result3</td>
				    </tr>
				    <tr style="border-bottom: 1px solid rgba(85, 155, 152, .4); line-height: 1.8em;font-size: 16px"">
				      <td style="width: 55%;  color: #4A4A4A;">Amount of Meals Created:</td>
				      <td id="result4" style="width: 45%; text-align: right; font-weight: bold;color: #559B98;">result4</td>
				    </tr>
				  </tbody>
				</table>
			</div>
			<div id="excerciseWrapper">
				<div id="excercise_Priority">
					<h3 id="priority_ExcerciseTitle">Customize Your Priorities</h3>
					<h5 id="priority_ExcerciseBody">Change the default settings for your farm choices to see how each shift influences your overall performance.</h5>
					<div id="priority_Example_Wrapper">
						<div id="example">
							<div id="slider-connect2" class="noUi-target noUi-ltr noUi-horizontal">
							</div>
							<div class="Priority-Label">Environmental Priority:<span id="environmental-value"></span>%</div>
							<div class="Priority-Label">Profitability Priority:<span id="profitability-value"></span>%</div>
							<div class="Priority-Label">Consumability Priority:<span id="consumability-value"></span>%</div>
			
						</div>
					</div>
				</div>
				<div id="excercise_Scale">
					
				</div>
				<div id="excercise_Cost">
					
				</div>
			</div>
		</div>
		<a><button id="EnterCommunityButton">
		Finalize Garden
		</button></a>
	</div>

<script type="text/javascript">

	$( document ).ready(function() {
  //   	console.log(localStorage.getItem("first"));
		// console.log(localStorage.getItem("second"));
		// console.log(localStorage.getItem("third"));
		$(".check").delay(400).animate({
			opacity: 1
		}, 400,function(){

		});
		$("#line1").animate({
			width: "31px"
		}, 400,function(){

		});

		$("#line2").delay(800).animate({
			width: "31px"
		}, 400, function(){

		});

		var combinedCategories = localStorage.getItem("Priority") + localStorage.getItem("Scale") + localStorage.getItem("Cost");

	
		console.log(combinedCategories);

		var gardenData;

		loadEverything(combinedCategories);

		console.log("This is garden data",gardenData);
	


		function loadEverything (x) {

			$("#CustomFarmImg2Wrapper").prepend("<img id='SecondImg' src='Assets/PNG_72ppi/" + x +".png'/>");
			// $(".CustomFarmImg").remove();
			$(".CustomFarmImg2").remove();
			var url = x + ".json";

			var json = (function (){
			var json = null;
			$.ajax({
				'async': false,
				'global': false,
				'url': url,
				'dataType': "json",
				'success': function(data){
					console.log("This is jquery response",data);
					gardenData = data;
				}
			});
			console.log("Returned Value",json);
			// return json;
			})();
		}

		document.getElementById("priorityHeader").innerHTML = gardenData.DotTitle1;
		document.getElementById("scaleHeader").innerHTML = gardenData.DotTitle2;
		document.getElementById("costHeader").innerHTML = gardenData.DotTitle3;



		var priority = localStorage.getItem("Priority");
		var scale = localStorage.getItem("Scale");
		var cost = localStorage.getItem("Cost");

		prependCatalog(priority, scale, cost);

		function prependCatalog (a, b, c) {
				$("#priorityWrapper").prepend("<img id='priorityImg' class='catalogItem' src='Assets/individual_Choices/" + a +".png'/>");
				$("#scaleWrapper").prepend("<img id='scaleImg' class='catalogItem' src='Assets/individual_Choices/" + b +".png'/>");
				$("#costWrapper").prepend("<img id='costImg' class='catalogItem' src='Assets/individual_Choices/" + c +".png'/>");
			}

		document.getElementById("result1").innerHTML = gardenData.VegetableValue;
		document.getElementById("result2").innerHTML = gardenData.WaterSavedValue;
		document.getElementById("result3").innerHTML = gardenData.GasolineValue;
		document.getElementById("result4").innerHTML = gardenData.MealsCreatedValue;

		$(".catalogItem").mouseover(function(){
			console.log("Returned Value", gardenData);
			var itemName = this.id;
			if(itemName =="priorityImg") {
				$("#priorityWrapper").css("opacity", "1");
			}
			if(itemName =="scaleImg") {
				$("#scaleWrapper").css("opacity", "1");
			}
			if(itemName =="costImg") {
				$("#costWrapper").css("opacity", "1");
			}
		});
		$(".catalogItem").mouseleave(function(){
			if(!opacityBoolean.priorityImg) $("#priorityWrapper").css("opacity", "");
			if(!opacityBoolean.scaleImg) $("#scaleWrapper").css("opacity", "");
			if(!opacityBoolean.costImg) $("#costWrapper").css("opacity", "");

		});

		// this is our global opacity boolean that will keep track of which image should stay opaque
		var opacityBoolean = {priorityImg:false, scaleImg:false, costImg:false};

		$(".catalogItem").click(function(){
			var itemName = this.id;
			$("body,html").animate(
		        {
		            scrollTop : 1260                       // Scroll 500px from top of body
		        }, 2000); 

			if(itemName =="priorityImg") {
				$("#priorityWrapper").css("opacity", "1");
				opacityBoolean.priorityImg = true;
				opacityBoolean.scaleImg = false;
				opacityBoolean.costImg = false;
				//append excercise 1//
				//if priority = 
			}

			if(itemName =="scaleImg") {
				$("#scaleWrapper").css("opacity", "1");
				opacityBoolean.priorityImg = false;
				opacityBoolean.scaleImg = true;
				opacityBoolean.costImg = false;
				//append excercise 2//
			}

			if(itemName =="costImg") {
				$("#costWrapper").css("opacity", "1");
				opacityBoolean.priorityImg = false;
				opacityBoolean.scaleImg = false;
				opacityBoolean.costImg = true;
				//append excercise 3//
			}
			
		});

		var globalZ = 120; //TODO: set this global variable to change the size of the 'farm'

		// setting slider constants for connectSlider2
		var connectSlider2 = document.getElementById('slider-connect2');
		var maxSliderValue = 100;
		var minSliderValue = 0;
		var minSliderLimit = 60;
		var maxSliderLimit = 100;

		noUiSlider.create(connectSlider2, {
			start: [minSliderLimit, minSliderLimit + (maxSliderLimit - minSliderLimit)/2],
			connect: [true, true, true],
			// padding: [ 10, 15 ],
			range: {
			  'min': minSliderValue,
			  'max': maxSliderValue
			},
			pips: {
				mode: 'values',
				values: [], //TODO: Add values and format in CSS
				density: 4
			},
			margin:5
		});

		var connect = connectSlider2.querySelectorAll('.noUi-connect');
		var classes = ['c-1-color', 'c-2-color', 'c-3-color'];

		for ( var i = 0; i < connect.length; i++ ) {
		    connect[i].classList.add(classes[i]);
		}

		// 20% soft slider bounce code
		connectSlider2.noUiSlider.on('change', function ( values, handle ) {
			if ( values[handle] < minSliderLimit ) {
				connectSlider2.noUiSlider.set(minSliderLimit);
			} else if ( values[handle] > maxSliderLimit ) {
				connectSlider2.noUiSlider.set(maxSliderLimit);
			}
		});

		var calcConst = {
			//z values need to be updated by user choices
			c:{ //consumability
				A:0.171, B:12, X:0.83, Y:5.7
			},
			p:{ //profitability
				A:2.133, B:22.4, X:3.33, Y:0.2
			},
			e:{ //environmental
				A:0.147, B:5.16, X:0.83, Y:29.35
			},
			z:globalZ
		};

		// console.log(calcConst.consumability.A);
		// grabbing slider values
		// Display the slider value and how far the handle moved
		// from the left edge of the slider.
		connectSlider2.noUiSlider.on('update', function ( values, handle, unencoded, isTap, positions ) {
			
			var connectorTagID = {}
			console.log(priority);
			var values = connectSlider2.noUiSlider.get();
			var connector1 = values[0];
			var connector2 = values[1] - values[0];
			var connector3 = maxSliderValue - values[1];
			var pConnect, eConnect, cConnect = null;
			switch(priority){
				case("E"):
					eConnect = connector1;
					pConnect = connector2;
					cConnect = connector3;
					break;
				case("P"):
					pConnect = connector1;
					eConnect = connector2;
					cConnect = connector3;
					break;
				case("C"):
					cConnect = connector1;
					pConnect = connector2;
					eConnect = connector3;
					break
				default:
				break;
			}
			
			// connector order dictated by which of the three -value attributes was preferenced
			document.getElementById('environmental-value').innerHTML = Math.round(eConnect);
			document.getElementById('profitability-value').innerHTML = Math.round(pConnect);
			document.getElementById('consumability-value').innerHTML = Math.round(cConnect);			
			var weightedCalcConst = calcAvgWeighted(calcConst, eConnect, pConnect, cConnect);
			var tableValues = calcOutputValues(weightedCalcConst, calcConst);
			
			document.getElementById("result1").innerHTML = "$" + Math.round(tableValues.cropVal) + " /Year"; 
			document.getElementById("result2").innerHTML = Math.round(tableValues.waterUse) + " Gallons/Year"; 
			document.getElementById("result3").innerHTML = Math.round(tableValues.co2Emit) + " Gallons of Gas";
			document.getElementById("result4").innerHTML = Math.round(tableValues.meals) + " Meals/Year";
			// Jordan's senior year math thesis:

		});


		/**
		Determine the values to be output into final table based on user choices and slider values
		inputs: weighted calculation constants as wcc, calculation constants for z values
		output: JSON of {}
		**/
		function calcOutputValues(wcc, cc){
			var cropVal = cc.z * wcc.X * wcc.B * wcc.A;
			var waterUse = cc.z * wcc.X * wcc.Y;
			var co2Emit = (cc.z * 100 / 4536) * 4;
			var meals = (cc.z / 10) * wcc.B;
			var output = {cropVal:cropVal, waterUse:waterUse, co2Emit:co2Emit, meals:meals};
			return output;

		}



		/**
		Takes weighted average of cc values with weights eV, pV, and cV
		as determined by Jordan's 'special' formula
		**/
		function calcAvgWeighted(cc, eV, pV, cV){
			var output = {
				A:0,
				B:0,
				X:0,
				Y:0
			}
			for (var k in cc.c) {
				if(output.hasOwnProperty(k)){
					output[k] += cc.c[k]*cV/100;
				}				
			}
			for (var k in cc.p) {
				if(output.hasOwnProperty(k)){
					output[k] += cc.p[k]*pV/100;
				}				
			}
			for (var k in cc.e) {
				if(output.hasOwnProperty(k)){
					output[k] += cc.e[k]*eV/100;
				}				
			}
			// for(var k in output){
			// 	output[k] = Math.round(output[k]);
			// }
			return output;

		}

			// <text id="enviromental-value"></text>
			// 				<text id="profitability-value"></text>
			// 				<text id="consumability-value"></text>


	// $('input[ type="range"]').rangeslider({
	// 		  // Feature detection the default is `true`.
	// 	    // Set this to `false` if you want to use
	// 	    // the polyfill also in Browsers which support
	// 	    // the native <input type="range"> element.
	// 	    polyfill: false,

	// 	    // Callback function
	// 	    onInit: function() {
	
	// 	    },

	// 	    // Callback function
	// 	    onSlide: function(position, value) {

	// 	    },

	// 	    // Callback function
	// 	    onSlideEnd: function(position, value) {
	// 	    	console.log(value);
	// 	    }
	// 	});





	 
	 $('#mission_Statement').click(function(){
				$("#missionStatementContentWrapper").css("z-index", "102");
				$("#missionStatementContentWrapper").css("opacity", "1");

			});

			$('.xm2').click(function(){
				$("#missionStatementContentWrapper").css("opacity", "");
				$("#missionStatementContentWrapper").delay(800).queue(function(next) {
					$(this).css("z-index", "");
					next();
				});

			});

	$('#EnterCommunityButton').click(function(){
				$("#nameGardenContentWrapper").css("z-index", "102");
				$("#nameGardenContentWrapper").css("opacity", "1");

			});

			$('.xm3').click(function(){
				$("#nameGardenContentWrapper").css("opacity", "");
				$("#nameGardenContentWrapper").delay(800).queue(function(next) {
					$(this).css("z-index", "");
					next();
				});

			});

	$(window).scroll( function(){

  //get scroll position
  var topWindow = $(window).scrollTop();
  //multipl by 1.5 so the arrow will become transparent half-way up the page
  var topWindow = topWindow * 1.5;
  
  //get height of window
  var windowHeight = $(window).height();
      
  //set position as percentage of how far the user has scrolled 
  var position = topWindow / windowHeight;
  //invert the percentage
  position = 1 - position;

  //define arrow opacity as based on how far up the page the user has scrolled
  //no scrolling = 1, half-way up the page = 0
  $('.arrow-wrap').css('opacity', position);

	});

	$(".arrow-wrap").click(function()  // When arrow is clicked
		    {
		        $("body,html").animate(
		        {
		            scrollTop : 670                       // Scroll 500px from top of body
		        }, 1000);  //how fast the scrolling animation will be in miliseconds
		    });

		/* initializing firebase */
		var config = {
			apiKey: "AIzaSyCz8j_wouFYfrsdMHfw-Asx90Z0ujSZlNo",
			authDomain: "herban-f14b6.firebaseapp.com",
			databaseURL: "https://herban-f14b6.firebaseio.com/",
			projectId: "herban-f14b6",
			storageBucket: "herban-f14b6.appspot.com",
			messagingSenderId: "577414616663" 
		};
		firebase.initializeApp(config);
		

		function writeNewPost() {
			// A post entry.

			var postData = {
				// A_customizedName: value1,
				B_groceryDecreased: "number_grocery_decreased",
				C_groceryDecreased: "number_grocery_decreased",
				D_groceryDecreased: "number_grocery_decreased",
				E_groceryDecreased: "number_grocery_decreased"
			};
		
			// Get a key for a new Post.
			var newPostKey = firebase.database().ref().child('users').push().key;
		
			// Write the new post's data simultaneously in the posts list and the user's post list.
			var updates = {};
			updates['/users/' + newPostKey] = postData;
			return firebase.database().ref().update(updates);
		}

		// writeNewPost();
});	


		
</script>
</body>
</html>